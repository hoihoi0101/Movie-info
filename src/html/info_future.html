<!DOCTYPE html>
<html lang="ko">
    <div id="headers"></div>
<head>
    <meta charset="UTF-8">
    <title>개봉예정작-상세정보페이지</title>
    <link rel="stylesheet" href="../css/infostyle.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <div class="movie-info">
            <img src="image url">
            <div class="movie-info-content">
                <h2>기본 정보</h2>
                <p>제목: <span>영화 제목 작성</span></p>
                <p>개봉 일자: <span>YYYY-MM-DD</span></p>
                <p>장르: <span>장르 작성</span></p>
                <p>러닝 타임: <span>런닝 타임 작성</span></p>
            </div>
        </div>
        <div class="movie-info">
            <div class="reserv">
                <p>예약하러 가기 ➜ &nbsp; </p>
            </div>
            <div class="button-row">
                <a href="http://www.cgv.co.kr/ticket/" target="_blank" class="brand-button">CGV</a> &nbsp;
                <a href="https://www.megabox.co.kr/booking" target="_blank" class="brand-button">메가박스</a> &nbsp;
                <a href="https://www.lottecinema.co.kr/NLCHS/Ticketing" target="_blank" class="brand-button">롯데시네마</a>
                &nbsp;
            </div>
        </div>

        <div class="movie-info">
            <div class="movie-info-content">
                <h2>감독/출연</h2>
                <p>감독: <span>감독 작성</span></p>
                <ul>
                    <li><span>배우 1</span></li>
                    <li><span>배우 2</span></li>
                </ul>
            </div>
        </div>
        <!-- 기대 메시지 -->
        <div class="review-section">
            <h2>기대/응원의 메시지</h2>
            <ul class="review-list">
                <li class="review-item">
                    <div class="name">이름1</div>
                    <div>★★★★☆</div>
                    <div>리뷰 내용1</div>
                </li><br>
                <li class="review-item">
                    <div class="name">이름2</div>
                    <div>★★★☆☆</div>
                    <div>리뷰 내용2</div>
                </li><br>
            </ul>
            <div class="comment-input">
                <div class="comment-input-container">
                    <br>
                    <div>이름</div>
                    <input type="text" class="name-input" placeholder="이름을 입력하세요.">
                </div>
                <div>메시지</div>
                <textarea placeholder="기대/응원의 메시지를 적어주세요!"></textarea>
                <button class="save-review-button">작성</button>
            </div>
        </div>
        <!-- 리뷰 섹션 끝 -->
    </div>
    <button id="scroll-to-top-button" title="맨 위로 이동" onclick="scrollToTop()">^</button>
</body>
<div id="footers"></div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
<script>
    $(document).ready(function () {

        // 스크롤 관련 -----------------------------------------------------------------
        function scrollToTop() {
            $('html, body').animate({scrollTop: 0}, 'smooth');
        }

        $(window).scroll(function () {
            const scrollPosition = $(this).scrollTop();
            const scrollToTopButton = $("#scroll-to-top-button");

            if (scrollPosition > 200) {
                scrollToTopButton.show();
            } else {
                scrollToTopButton.hide();
            }
        });

        $("#scroll-to-top-button").click(function () {
            scrollToTop();
        });


        // 체크박스 정의
        const checkboxes = Array.from(document.querySelectorAll('.rating input[type="checkbox"]'));
        function updateRating() {
            const selectedCheckbox = checkboxes.find((checkbox) => checkbox.checked);
            let selectedIndex = selectedCheckbox ? checkboxes.indexOf(selectedCheckbox) : -1;

            if (selectedIndex >= 0) {
                checkboxes.forEach((checkbox, i) => {
                    checkbox.checked = i <= selectedIndex;
                });
            }
        }

        // 체크박스 받아오기
        checkboxes.forEach((checkbox) => {
            checkbox.addEventListener('click', () => {
                updateRating();
            });
        });

        // 리뷰 저장 ----------------------------------------------
        function saveReviewsToLocal(reviews) {
            localStorage.setItem('reviews', JSON.stringify(reviews));
        }

        function getReviewsFromLocal() {
            const storedReviews = localStorage.getItem('reviews');
            return storedReviews ? JSON.parse(storedReviews) : [];
        }

        function createReviewItem(name, ratingStars, content) {
            return $("<li>", { class: "review-item" })
                .append($("<div>", { class: "name", text: name }))
                .append($("<div>", { text: "★".repeat(ratingStars) })) // 별점
                .append($("<div>", { html: content }))
                .append($("<br>")); // 여기 수정
        }

        function displayReviews() {
            const reviewList = $(".review-list");
            reviewList.empty();
            const storedReviews = getReviewsFromLocal();

            storedReviews.forEach(function (review) {
                const newReview = createReviewItem(review.name, review.ratingStars, review.content); // 여기 수정
                reviewList.append(newReview);
            });
        }

        function addReview(name, ratingIndex, content) {
            const storedReviews = getReviewsFromLocal();
            const ratingStars = ratingIndex ; // 여기 수정
            storedReviews.push({ name, ratingStars, content });
            saveReviewsToLocal(storedReviews);
            displayReviews();
        }

        $(".save-review-button").click(function () {
            const nameInput = $(".name-input");
            const ratingIndex = checkboxes.filter((el) => el.checked).length;
            const contentTextarea = $("textarea");

            const name = nameInput.val();
            const content = contentTextarea.val();

            if (name) {
                if (ratingIndex >= 0) {
                    addReview(name, ratingIndex, content);
                    nameInput.val('');
                    checkboxes.forEach((checkbox) => { checkbox.checked = false; });
                    contentTextarea.val('');
                } else {
                    alert('별점을 선택하세요.');
                }
            } else {
                alert('이름을 입력하세요.');
            }
        });

        displayReviews();
    });
</script>


<script src="../js/jquery-3.7.0.min.js"></script>
<script type="text/javascript">

    $(document).ready(function () {

        $("#headers").load("header.html");
        $("#footers").load("footer.html");
        $("#side").load("side.html");
        $("#contents").load("contents-now.html");
        $("#slide").load("slide.html");
    });

    $(document).ready(function () {
        function changePage1() {
            $("#contents").load("contents-now.html");
            var newContent = '현재 상영작';
            $('#category-name').html(newContent);
        }


        $('#now').click(function () {
            changePage1();
        });


    });

    $(document).ready(function () {
        function changePage2() {
            $("#contents").load("contents-future.html");
            var newContent = '개봉 예정작';
            $('#category-name').html(newContent);
        }


        $('#future').click(function () {
            changePage2();
        });


    });


</script>

</html>